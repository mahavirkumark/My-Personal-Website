<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Credential Manager</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <style>
    /* Animations */
    .fade-in { opacity: 0; transform: translateY(20px); animation: fadeInUp 0.8s forwards; }
    .slide-left { opacity: 0; transform: translateX(-20px); animation: slideLeft 0.8s forwards; }
    .slide-right { opacity: 0; transform: translateX(20px); animation: slideRight 0.8s forwards; }

    @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
    @keyframes slideLeft { to { opacity: 1; transform: translateX(0); } }
    @keyframes slideRight { to { opacity: 1; transform: translateX(0); } }

    nav a { transition: transform 0.3s, color 0.3s; }
    nav a:hover { transform: translateY(-2px); color: #3b82f6; }
  </style>
</head>
<body class="bg-gray-100 text-gray-700 font-sans">

<div class="hidden md:block fade-in">
  <header class="bg-white shadow-md p-4 flex justify-between items-center">
    <div class="flex items-center gap-3 slide-left">
      <i class="fas fa-user-circle text-3xl text-blue-500"></i>
      <h1 class="text-2xl font-bold text-black">My Personal Website</h1>
    </div>

    <nav class="flex items-center gap-6 text-lg font-normal text-gray-800 slide-right">
      <a href="home.html" class="flex items-center gap-2"><i class="fas fa-house"></i> Home</a>
      <a href="adress.html" class="flex items-center gap-2"><i class="fas fa-tasks"></i> Address</a>
      <a href="income.html" class="flex items-center gap-2"><i class="fas fa-wallet"></i> Income</a>
      <a href="links.html" class="flex items-center gap-2"><i class="fas fa-link"></i> Links</a>
      <a href="calender.html" class="flex items-center gap-2"><i class="fas fa-calendar-days"></i> Calendar</a>
      <a href="password.html" class="flex items-center gap-2"><i class="fas fa-lock"></i> Passwords</a>
    </nav>

    <div class="flex items-center gap-4 slide-left">
      <div class="text-right">
        <p id="user-name" class="font-medium text-black text-base">User Name</p>
        <p id="user-email" class="text-sm text-gray-500">user@example.com</p>
        <p id="user-id" class="text-xs text-gray-400 hidden">UID here</p>
      </div>
      <img id="user-pic" src="https://via.placeholder.com/100" alt="User Photo" class="w-12 h-12 rounded-full border" />
      <button id="logout-btn" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm">Logout</button>
    </div>
  </header>

  <div class="w-full px-6 mx-auto mt-4 grid grid-cols-1 md:grid-cols-3 gap-4 max-w-screen-2xl">
    <div class="bg-white rounded shadow p-5 flex flex-col space-y-2 md:col-span-1 fade-in">
      <h2 class="text-lg font-semibold mb-1 text-center">Add New Credential</h2>
      <input id="title" class="border px-3 py-2 rounded text-sm" placeholder="App / Website Name (Required)" />
      <input id="email" class="border px-3 py-2 rounded text-sm" placeholder="Email (Optional)" />
      <input id="username" class="border px-3 py-2 rounded text-sm" placeholder="Username (Optional)" />
      <input id="password" class="border px-3 py-2 rounded text-sm" placeholder="Password (Optional)" />
      <button id="save-btn" class="bg-blue-900 text-white text-sm py-2 rounded hover:bg-blue-800 mt-2">
        <i class="fas fa-save mr-2"></i> Save Credential
      </button>
      <p id="save-message" class="text-center text-sm text-green-600 font-medium hidden">Credential saved!</p>
    </div>

    <div class="bg-white rounded shadow p-6 flex flex-col space-y-4 md:col-span-2 fade-in">
      <h2 class="text-lg font-semibold text-center">Saved Credentials</h2>
      <div class="flex justify-center">
        <input type="text" id="searchInput" placeholder="ðŸ” Search your passwords..." class="w-full max-w-2xl px-5 py-4 border border-gray-600 rounded-full shadow-sm focus:outline-none focus:ring-5 focus:ring-blue-600 text-[18px] font-bold transition" oninput="filterPasswords()" />
      </div>
      <div id="cred-list" class="grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-[65vh] overflow-y-auto"></div>
    </div>
  </div>
</div>

<div class="block md:hidden fade-in">
  <header class="bg-white shadow-md">
    <div class="flex justify-between items-center py-2 px-4">
      <div class="flex items-center gap-2 slide-left">
        <i class="fas fa-user-circle text-2xl text-blue-500"></i>
        <h1 class="text-lg font-bold text-black">My Personal Website</h1>
      </div>
      <button id="menu-btn" class="text-gray-700 hover:text-blue-500 focus:outline-none p-2 rounded-lg">
        <i class="fas fa-bars text-xl"></i>
      </button>
    </div>
  </header>

  <nav id="mobile-menu" class="hidden bg-white px-6 pb-6 space-y-3 text-base font-normal text-gray-800 rounded-b shadow-md">
    <a href="home.html" class="flex items-center gap-2 px-3 py-2 rounded hover:bg-gray-100"><i class="fas fa-house"></i> Home</a>
    <a href="adress.html" class="flex items-center gap-2"><i class="fas fa-tasks"></i> Address</a>
    <a href="income.html" class="flex items-center gap-2"><i class="fas fa-wallet"></i> Income</a>
    <a href="links.html" class="flex items-center gap-2"><i class="fas fa-link"></i> Links</a>
    <a href="calender.html" class="flex items-center gap-2"><i class="fas fa-calendar-days"></i> Calendar</a>
    <a href="password.html" class="flex items-center gap-2"><i class="fas fa-lock"></i> Passwords</a>

    <button id="mobileProfileBtn" class="flex items-center gap-2 mt-4 w-full text-left px-3 py-2 rounded hover:bg-gray-100 focus:outline-none">
      <i class="fas fa-user-circle text-2xl"></i>
      <span class="font-medium">Profile</span>
      <i class="fas fa-chevron-down ml-auto transition-transform duration-300" id="mobileProfileChevron"></i>
    </button>

    <div id="mobileProfilePanel" class="hidden mt-2 p-3 border rounded bg-gray-50 space-y-2">
      <p id="mobileUserName" class="font-medium text-gray-800 text-sm">User Name</p>
      <p id="mobileUserEmail" class="text-xs text-gray-500">user@example.com</p>
      <button id="mobileLogout" class="w-full mt-1 bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm">Logout</button>
    </div>
  </nav>

  <div class="bg-white rounded-lg shadow-lg p-4 mx-2 my-6 flex flex-col space-y-6 fade-in">
    <div class="bg-white rounded-lg shadow p-4 space-y-3 w-full">
      <h3 class="text-lg font-semibold mb-2 text-center text-gray-700">Add New Credential</h3>
      <input id="title-m" class="border px-3 py-2 rounded text-sm w-full focus:ring-2 focus:ring-blue-500" placeholder="App / Website Name (Required)" />
      <input id="email-m" class="border px-3 py-2 rounded text-sm w-full focus:ring-2 focus:ring-blue-500" placeholder="Email (Optional)" />
      <input id="username-m" class="border px-3 py-2 rounded text-sm w-full focus:ring-2 focus:ring-blue-500" placeholder="Username (Optional)" />
      <input id="password-m" class="border px-3 py-2 rounded text-sm w-full focus:ring-2 focus:ring-blue-500" placeholder="Password (Optional)" />

      <button id="save-btn-m" class="bg-blue-700 text-white text-sm py-2 rounded hover:bg-blue-600 mt-2 w-full flex justify-center items-center font-medium transition">
        <i class="fas fa-save mr-2"></i> Save Credential
      </button>
      <p id="save-message-m" class="text-center text-sm text-green-600 font-medium hidden">Credential saved!</p>
    </div>

    <input type="text" id="searchInputMobile" placeholder="ðŸ” Search your passwords..." class="w-full px-3 py-2 border border-gray-400 rounded-full shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm font-medium transition" />

    <h2 class="text-lg font-semibold text-center">Saved Credentials</h2>
    <div id="cred-list-mobile" class="grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
  </div>
</div>

<footer class="mt-12 pt-3 pb-3 bg-white text-gray-600 text-center text-sm border-t">
  &copy; 2025 Personal Website | All rights reserved
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script>
Â  // ** Core Application Logic **

Â  // Firebase Configuration
Â  const firebaseConfig = {
Â  Â  apiKey: "AIzaSyB78RTVCg0cmSPp7A1RJyyAgBuCeolO0cc",
Â  Â  authDomain: "sk12-58e9e.firebaseapp.com",
Â  Â  databaseURL: "https://sk12-58e9e-default-rtdb.firebaseio.com",
Â  Â  projectId: "sk12-58e9e",
Â  Â  storageBucket: "sk12-58e9e.appspot.com",
Â  Â  messagingSenderId: "470207874652",
Â  Â  appId: "1:470207874652:web:67ba1cf3629b7e5b144899"
Â  };
Â  firebase.initializeApp(firebaseConfig);
Â  const auth = firebase.auth();
Â  const db = firebase.database();
Â  let currentUser = null;

Â  // Encryption Key - This is for demonstration. In a real app, this key should be generated dynamically and stored securely.
Â  const ENCRYPTION_KEY = "YourSecretKey_ChangeThis"; // CHANGE THIS IN PRODUCTION!

Â  // Function to encrypt a string
Â  const encryptString = (text) => {
Â  Â  return CryptoJS.AES.encrypt(text, ENCRYPTION_KEY).toString();
Â  };

Â  // Function to decrypt a string
Â  const decryptString = (ciphertext) => {
Â  Â  if (!ciphertext || ciphertext === "[object Object]") {
Â  Â  Â  return "No data";
Â  Â  }
Â  Â  try {
Â  Â  Â  const bytes = CryptoJS.AES.decrypt(ciphertext, ENCRYPTION_KEY);
Â  Â  Â  return bytes.toString(CryptoJS.enc.Utf8);
Â  Â  } catch (e) {
Â  Â  Â  console.error("Decryption failed:", e);
Â  Â  Â  return "Decryption Failed";
Â  Â  }
Â  };

Â  // Function to save a new credential
Â  const saveCredential = (isMobile = false) => {
Â  Â  const titleId = isMobile ? "title-m" : "title";
Â  Â  const emailId = isMobile ? "email-m" : "email";
Â  Â  const usernameId = isMobile ? "username-m" : "username";
Â  Â  const passwordId = isMobile ? "password-m" : "password";
Â  Â  const saveBtnId = isMobile ? "save-btn-m" : "save-btn";
Â  Â  const messageId = isMobile ? "save-message-m" : "save-message";

Â  Â  const title = document.getElementById(titleId)?.value.trim();
Â  Â  const email = document.getElementById(emailId)?.value.trim();
Â  Â  const username = document.getElementById(usernameId)?.value.trim();
Â  Â  const password = document.getElementById(passwordId)?.value.trim();
Â  Â  const saveBtn = document.getElementById(saveBtnId);
Â  Â  const saveMessage = document.getElementById(messageId);

Â  Â  if (!title) {
Â  Â  Â  alert("App/Website title is required!");
Â  Â  Â  return;
Â  Â  }
Â  Â Â 
Â  Â  // Show saving state
Â  Â  saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Saving...';
Â  Â  saveBtn.disabled = true;

Â  Â  // ENCRYPT DATA BEFORE SAVING
Â  Â  const encryptedData = {
Â  Â  Â  title: title,
Â  Â  Â  email: email ? encryptString(email) : "",
Â  Â  Â  username: username ? encryptString(username) : "",
Â  Â  Â  password: password ? encryptString(password) : ""
Â  Â  };

Â  Â  const id = Date.now().toString();
Â  Â  db.ref(`users/${currentUser.uid}/credentials/${id}`).set(encryptedData)
Â  Â  Â  .then(() => {
Â  Â  Â  Â  // Show success message and reset button
Â  Â  Â  Â  saveMessage.classList.remove("hidden");
Â  Â  Â  Â  saveBtn.innerHTML = '<i class="fas fa-save mr-2"></i> Save Credential';
Â  Â  Â  Â  saveBtn.disabled = false;
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Hide message and clear fields after a delay
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  saveMessage.classList.add("hidden");
Â  Â  Â  Â  Â  const inputIds = [titleId, emailId, usernameId, passwordId];
Â  Â  Â  Â  Â  inputIds.forEach(id => {
Â  Â  Â  Â  Â  Â  const el = document.getElementById(id);
Â  Â  Â  Â  Â  Â  if (el) el.value = "";
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  document.getElementById(titleId)?.focus();
Â  Â  Â  Â  }, 2000);
Â  Â  Â  })
Â  Â  Â  .catch((error) => {
Â  Â  Â  Â  console.error("Error saving credential:", error);
Â  Â  Â  Â  alert("Failed to save credential. Please try again.");
Â  Â  Â  Â  saveBtn.innerHTML = '<i class="fas fa-save mr-2"></i> Save Credential';
Â  Â  Â  Â  saveBtn.disabled = false;
Â  Â  Â  });
Â  };

Â  // Function to load all user credentials
Â  const loadCredentials = () => {
Â  Â  const desktopList = document.getElementById("cred-list");
Â  Â  const mobileList = document.getElementById("cred-list-mobile");
Â  Â Â 
Â  Â  if (desktopList) desktopList.innerHTML = `<p class="text-gray-500">Loading...</p>`;
Â  Â  if (mobileList) mobileList.innerHTML = `<p class="text-gray-500">Loading...</p>`;

Â  Â  db.ref(`users/${currentUser.uid}/credentials`).on("value", snapshot => {
Â  Â  Â  if (desktopList) desktopList.innerHTML = "";
Â  Â  Â  if (mobileList) mobileList.innerHTML = "";

Â  Â  Â  if (!snapshot.exists()) {
Â  Â  Â  Â  const noCredsMessage = `<p class="text-gray-500">No credentials found.</p>`;
Â  Â  Â  Â  if (desktopList) desktopList.innerHTML = noCredsMessage;
Â  Â  Â  Â  if (mobileList) mobileList.innerHTML = noCredsMessage;
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  snapshot.forEach(child => {
Â  Â  Â  Â  const encryptedData = child.val();
Â  Â  Â  Â  const id = child.key;

Â  Â  Â  Â  // DECRYPT DATA AFTER LOADING
Â  Â  Â  Â  const decryptedData = {
Â  Â  Â  Â  Â  title: encryptedData.title,
Â  Â  Â  Â  Â  email: encryptedData.email ? decryptString(encryptedData.email) : "",
Â  Â  Â  Â  Â  username: encryptedData.username ? decryptString(encryptedData.username) : "",
Â  Â  Â  Â  Â  password: encryptedData.password ? decryptString(encryptedData.password) : ""
Â  Â  Â  Â  };

Â  Â  Â  Â  const safeData = encodeURIComponent(JSON.stringify(decryptedData));

Â  Â  Â  Â  const html = `
Â  Â  Â  Â  Â  <div class="password-item border p-4 rounded shadow bg-gray-50 flex flex-col" data-id="${id}">
Â  Â  Â  Â  Â  Â  <h3 class="website-name font-semibold text-lg text-black mb-2">${decryptedData.title || "Untitled"}</h3>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  ${decryptedData.email && decryptedData.email !== "No data" ? `
Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-gray-600 flex items-center justify-between mb-1">
Â  Â  Â  Â  Â  Â  Â  Â  <span>Email: <span class="cred-value email-value" data-original="${decryptedData.email}">â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</span></span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="flex items-center gap-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="toggleVisibility(this)" class="text-gray-500 hover:text-gray-900 text-sm">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-eye-slash"></i>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="copyToClipboard('${decryptedData.email}', this)" class="px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700">Copy</button>
Â  Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  </p>` : ''}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  ${decryptedData.username && decryptedData.username !== "No data" ? `
Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-gray-600 flex items-center justify-between mb-1">
Â  Â  Â  Â  Â  Â  Â  Â  <span>Username: <span class="cred-value username-value" data-original="${decryptedData.username}">â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</span></span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="flex items-center gap-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="toggleVisibility(this)" class="text-gray-500 hover:text-gray-900 text-sm">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-eye-slash"></i>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="copyToClipboard('${decryptedData.username}', this)" class="px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700">Copy</button>
Â  Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  </p>` : ''}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  ${decryptedData.password && decryptedData.password !== "No data" ? `
Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-gray-600 flex items-center justify-between mb-1">
Â  Â  Â  Â  Â  Â  Â  Â  <span>Password: <span class="cred-value password-value" data-original="${decryptedData.password}">â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</span></span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="flex items-center gap-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="toggleVisibility(this)" class="text-gray-500 hover:text-gray-900 text-sm">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-eye-slash"></i>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="copyToClipboard('${decryptedData.password}', this)" class="px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700">Copy</button>
Â  Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  </p>` : ''}

Â  Â  Â  Â  Â  Â  <div class="mt-3 flex gap-3 justify-start">
Â  Â  Â  Â  Â  Â  Â  <button onclick="editCredential('${id}', '${safeData}')" class="text-blue-600 hover:underline"><i class="fas fa-edit mr-1"></i>Edit</button>
Â  Â  Â  Â  Â  Â  Â  <button onclick="deleteCredential('${id}')" class="text-red-600 hover:underline"><i class="fas fa-trash mr-1"></i>Delete</button>
Â  Â  Â  Â  Â  Â  Â  <button onclick="shareCredential('${decryptedData.title}', '${decryptedData.email || ''}', '${decryptedData.username || ''}', '${decryptedData.password || ''}')" class="text-green-600 hover:underline">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-share-alt mr-1"></i>Share
Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  `;
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (desktopList) desktopList.innerHTML += html;
Â  Â  Â  Â  if (mobileList) mobileList.innerHTML += html;
Â  Â  Â  });

Â  Â  Â  filterPasswords();
Â  Â  Â  filterPasswordsMobile();
Â  Â  });
Â  };

Â  // ** UI Interactions and Utility Functions **

Â  // Copy function with visual feedback
Â  const copyToClipboard = (text, button) => {
Â  Â  navigator.clipboard.writeText(text).then(() => {
Â  Â  Â  const originalText = "Copy";
Â  Â  Â  const newText = "Copied!";
Â  Â  Â Â 
Â  Â  Â  button.innerText = newText;
Â  Â  Â  button.disabled = true;
Â  Â  Â  button.classList.remove("bg-blue-600");
Â  Â  Â  button.classList.add("bg-green-600");
Â  Â  Â  button.style.transform = "scale(1.1)";
Â  Â  Â  button.style.transition = "all 0.2s ease-in-out";

Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  button.innerText = originalText;
Â  Â  Â  Â  button.disabled = false;
Â  Â  Â  Â  button.classList.remove("bg-green-600");
Â  Â  Â  Â  button.classList.add("bg-blue-600");
Â  Â  Â  Â  button.style.transform = "scale(1)";
Â  Â  Â  }, 1500);
Â  Â  });
Â  };

Â  // Toggle visibility of a credential field
Â  const toggleVisibility = (button) => {
Â  Â  const parent = button.closest("p");
Â  Â  if (!parent) return;

Â  Â  const valueSpan = parent.querySelector(".cred-value");
Â  Â  const isHidden = valueSpan.textContent === "â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢";

Â  Â  if (isHidden) {
Â  Â  Â  valueSpan.textContent = valueSpan.getAttribute("data-original");
Â  Â  Â  button.innerHTML = `<i class="fas fa-eye"></i>`;
Â  Â  Â  button.classList.remove("text-gray-500");
Â  Â  Â  button.classList.add("text-blue-600");
Â  Â  } else {
Â  Â  Â  valueSpan.textContent = "â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢";
Â  Â  Â  button.innerHTML = `<i class="fas fa-eye-slash"></i>`;
Â  Â  Â  button.classList.remove("text-blue-600");
Â  Â  Â  button.classList.add("text-gray-500");
Â  Â  }
Â  };

Â  // Edit a credential
Â  const editCredential = (id, encoded) => {
Â  Â  const decryptedData = JSON.parse(decodeURIComponent(encoded));

Â  Â  const newTitle = prompt("Edit Title:", decryptedData.title || "");
Â  Â  const newEmail = prompt("Edit Email:", decryptedData.email || "");
Â  Â  const newUsername = prompt("Edit Username:", decryptedData.username || "");
Â  Â  const newPassword = prompt("Edit Password:", decryptedData.password || "");

Â  Â  if (newTitle !== null) {
Â  Â  Â  const updatedData = {
Â  Â  Â  Â  title: newTitle,
Â  Â  Â  Â  email: newEmail ? encryptString(newEmail) : "",
Â  Â  Â  Â  username: newUsername ? encryptString(newUsername) : "",
Â  Â  Â  Â  password: newPassword ? encryptString(newPassword) : ""
Â  Â  Â  };
Â  Â  Â  db.ref(`users/${currentUser.uid}/credentials/${id}`).set(updatedData);
Â  Â  }
Â  };

Â  // Delete a credential
Â  const deleteCredential = (id) => {
Â  Â  if (confirm("Are you sure you want to delete this credential?")) {
Â  Â  Â  db.ref(`users/${currentUser.uid}/credentials/${id}`).remove();
Â  Â  }
Â  };

Â  // Share a credential using the Web Share API
Â  const shareCredential = (title, email, username, password) => {
Â  Â  let shareText = `Website/App: ${title}\n`;
Â  Â  if (email) shareText += `Email: ${email}\n`;
Â  Â  if (username) shareText += `Username: ${username}\n`;
Â  Â  if (password) shareText += `Password: ${password}\n`;

Â  Â  if (navigator.share) {
Â  Â  Â  navigator.share({
Â  Â  Â  Â  title: `Credential for ${title}`,
Â  Â  Â  Â  text: shareText
Â  Â  Â  }).then(() => {
Â  Â  Â  Â  console.log('Successfully shared!');
Â  Â  Â  }).catch((error) => {
Â  Â  Â  Â  console.error('Error sharing:', error);
Â  Â  Â  Â  alert("Sharing failed. Please try again.");
Â  Â  Â  });
Â  Â  } else {
Â  Â  Â  alert("Sharing is not supported on this browser.");
Â  Â  }
Â  };

Â  // Search function for desktop
Â  const filterPasswords = () => {
Â  Â  const query = document.getElementById("searchInput")?.value.toLowerCase() || "";
Â  Â  document.querySelectorAll("#cred-list .password-item").forEach(item => {
Â  Â  Â  const website = item.querySelector(".website-name")?.textContent.toLowerCase() || "";
Â  Â  Â  item.style.display = website.includes(query) ? "block" : "none";
Â  Â  });
Â  };

Â  // Search function for mobile
Â  const filterPasswordsMobile = () => {
Â  Â  const query = document.getElementById("searchInputMobile")?.value.toLowerCase() || "";
Â  Â  document.querySelectorAll("#cred-list-mobile .password-item").forEach(item => {
Â  Â  Â  const website = item.querySelector(".website-name")?.textContent.toLowerCase() || "";
Â  Â  Â  item.style.display = website.includes(query) ? "block" : "none";
Â  Â  });
Â  };
Â Â 
Â  // Mobile menu toggle
Â  const mobileMenuBtn = document.getElementById("menu-btn");
Â  const mobileMenu = document.getElementById("mobile-menu");
Â  if (mobileMenuBtn && mobileMenu) {
Â  Â  mobileMenuBtn.addEventListener("click", () => mobileMenu.classList.toggle("hidden"));
Â  }

Â  // Mobile profile toggle
Â  const mobileProfileBtn = document.getElementById("mobileProfileBtn");
Â  const mobileProfilePanel = document.getElementById("mobileProfilePanel");
Â  const mobileProfileChevron = document.getElementById("mobileProfileChevron");
Â  if (mobileProfileBtn && mobileProfilePanel && mobileProfileChevron) {
Â  Â  mobileProfileBtn.addEventListener("click", () => {
Â  Â  Â  mobileProfilePanel.classList.toggle("hidden");
Â  Â  Â  mobileProfileChevron.classList.toggle("rotate-180");
Â  Â  });
Â  }

Â  // ** Event Listeners and Authentication **

Â  // Save button click handlers
Â  const saveBtn = document.getElementById("save-btn");
Â  if (saveBtn) saveBtn.addEventListener("click", () => saveCredential(false));

Â  const saveBtnMobile = document.getElementById("save-btn-m");
Â  if (saveBtnMobile) saveBtnMobile.addEventListener("click", () => saveCredential(true));

Â  // Auth state listener
Â  auth.onAuthStateChanged(user => {
Â  Â  if (user) {
Â  Â  Â  currentUser = user;
Â  Â  Â Â 
Â  Â  Â  // Update desktop profile UI
Â  Â  Â  document.getElementById("user-name").innerText = user.displayName || "User";
Â  Â  Â  document.getElementById("user-email").innerText = user.email || "";
Â  Â  Â  document.getElementById("user-pic").src = user.photoURL || "https://via.placeholder.com/40";
Â  Â  Â Â 
Â  Â  Â  // Update mobile profile UI
Â  Â  Â  const mobileName = document.getElementById("mobileUserName");
Â  Â  Â  const mobileEmail = document.getElementById("mobileUserEmail");
Â  Â  Â  if (mobileName) mobileName.innerText = user.displayName || "User";
Â  Â  Â  if (mobileEmail) mobileEmail.innerText = user.email || "";
Â  Â  Â Â 
Â  Â  Â  loadCredentials();
Â  Â  } else {
Â  Â  Â  // Redirect to login page if not authenticated
Â  Â  Â  location.href = "index.html";
Â  Â  }
Â  });

Â  // Logout button click handlers
Â  const logoutBtn = document.getElementById("logout-btn");
Â  if (logoutBtn) logoutBtn.addEventListener("click", () => auth.signOut());
Â  const mobileLogout = document.getElementById("mobileLogout");
Â  if (mobileLogout) mobileLogout.addEventListener("click", () => auth.signOut());

Â  // Search input listeners
Â  document.getElementById("searchInput")?.addEventListener("input", filterPasswords);
Â  document.getElementById("searchInputMobile")?.addEventListener("input", filterPasswordsMobile);
</script>
</body>
</html>





























