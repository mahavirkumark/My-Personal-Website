<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Credential Manager</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>
<body class="bg-gray-100 text-gray-700">

<!-- ✅ Navbar -->
<nav class="bg-white shadow p-4 flex justify-between items-center">
  <div class="text-2xl font-bold text-blue-400">My Personal Website</div>
  <div class="flex space-x-6 text-gray-700 text-lg">
    <a href="home.html" class="hover:text-blue-500 flex items-center gap-1"><i class="fas fa-house"></i> Home</a>
    <a href="password.html" class="hover:text-blue-500 flex items-center gap-1"><i class="fas fa-key"></i> Passwords</a>
    <a href="income.html" class="hover:text-blue-500 flex items-center gap-1"><i class="fas fa-wallet"></i> Income</a>
    <a href="links.html" class="hover:text-blue-500 flex items-center gap-1"><i class="fas fa-link"></i> Links</a>
    <a href="calender.html" class="hover:text-blue-500 flex items-center gap-1"><i class="fas fa-calendar-alt"></i> Calendar</a>
  </div>
  <div class="flex items-center space-x-3">
    <div class="text-right">
      <p id="user-name" class="font-medium text-black text-sm">User Name</p>
      <p id="user-email" class="text-xs text-gray-600">user@example.com</p>
      <p id="user-id" class="text-xs text-gray-400 hidden">UID here</p>
    </div>
    <img id="user-pic" src="" alt="User Photo" width="40" class="rounded-full border" />
    <button id="logout-btn" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm">Logout</button>
  </div>
</nav>

<!-- ✅ Page Content -->
<div class="max-w-6xl mx-auto mt-10 grid grid-cols-1 md:grid-cols-2 gap-6">
  <!-- Add Credential -->
  <div class="bg-white rounded shadow p-6">
    <h2 class="text-xl font-semibold mb-4">Add New Credential</h2>
    <input id="title" class="border p-2 w-full mb-2" placeholder="App / Website Name (Required)" />
    <input id="email" class="border p-2 w-full mb-2" placeholder="Email (Optional)" />
    <input id="username" class="border p-2 w-full mb-2" placeholder="Username (Optional)" />
    <input id="password" class="border p-2 w-full mb-4" placeholder="Password (Optional)" />
    <button onclick="saveCredential()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 w-full">
      <i class="fas fa-save mr-2"></i> Save Credential
    </button>
  </div>

  <!-- Credential List -->
  <div class="bg-white rounded shadow p-6">
    <h2 class="text-xl font-semibold mb-4">Saved Credentials</h2>
    <ul id="cred-list" class="space-y-4"></ul>
  </div>
</div>

<!-- ✅ Footer -->
<footer class="mt-10 bg-white text-gray-600 text-center p-4 border-t">
  &copy; 2025 Personal Website | All rights reserved
</footer>

<!-- ✅ Firebase Script -->
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyB78RTVCg0cmSPp7A1RJyyAgBuCeolO0cc",
    authDomain: "sk12-58e9e.firebaseapp.com",
    databaseURL: "https://sk12-58e9e-default-rtdb.firebaseio.com",
    projectId: "sk12-58e9e",
    storageBucket: "sk12-58e9e.appspot.com",
    messagingSenderId: "470207874652",
    appId: "1:470207874652:web:67ba1cf3629b7e5b144899"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.database();
  let currentUser = null;

  function saveCredential() {
    const title = document.getElementById("title").value.trim();
    const email = document.getElementById("email").value.trim();
    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value.trim();

    if (!title) {
      alert("App/Website title is required!");
      return;
    }

    const id = Date.now().toString();
    db.ref("users/" + currentUser.uid + "/credentials/" + id).set({ title, email, username, password });

    document.getElementById("title").value = "";
    document.getElementById("email").value = "";
    document.getElementById("username").value = "";
    document.getElementById("password").value = "";
  }

  function loadCredentials() {
    const list = document.getElementById("cred-list");
    list.innerHTML = "";

    db.ref("users/" + currentUser.uid + "/credentials").on("value", (snapshot) => {
      list.innerHTML = "";
      snapshot.forEach(child => {
        const data = child.val();
        const id = child.key;

        const li = document.createElement("li");
        li.className = "border p-4 rounded bg-gray-50";

        li.innerHTML = `
          ${data.title ? `<p><strong>Website/App:</strong> ${data.title}</p>` : ""}
          ${data.email ? `<p><strong>Email:</strong> ${data.email}</p>` : ""}
          ${data.username ? `<p><strong>Username:</strong> ${data.username}</p>` : ""}
          ${data.password ? `<p><strong>Password:</strong> ${data.password}</p>` : ""}
          <div class="mt-3 flex gap-3">
            <button onclick="editCredential('${id}', ${JSON.stringify(data).replace(/"/g, '&quot;')})" class="text-blue-600 hover:underline">
              <i class="fas fa-edit mr-1"></i>Edit
            </button>
            <button onclick="deleteCredential('${id}')" class="text-red-600 hover:underline">
              <i class="fas fa-trash mr-1"></i>Delete
            </button>
          </div>
        `;
        list.appendChild(li);
      });
    });
  }

  function editCredential(id, data) {
    const newTitle = prompt("Edit Title:", data.title || "");
    const newEmail = prompt("Edit Email:", data.email || "");
    const newUsername = prompt("Edit Username:", data.username || "");
    const newPassword = prompt("Edit Password:", data.password || "");

    if (newTitle !== null) {
      db.ref("users/" + currentUser.uid + "/credentials/" + id).set({
        title: newTitle,
        email: newEmail || "",
        username: newUsername || "",
        password: newPassword || ""
      });
    }
  }

  function deleteCredential(id) {
    if (confirm("Are you sure you want to delete this credential?")) {
      db.ref("users/" + currentUser.uid + "/credentials/" + id).remove();
    }
  }

  document.getElementById("logout-btn").addEventListener("click", () => {
    auth.signOut().then(() => location.href = "login.html");
  });

  auth.onAuthStateChanged(user => {
    if (user) {
      currentUser = user;
      document.getElementById("user-name").innerText = user.displayName || "User";
      document.getElementById("user-email").innerText = user.email || "";
      document.getElementById("user-id").innerText = user.uid;
      document.getElementById("user-pic").src = user.photoURL || "https://via.placeholder.com/40";
      loadCredentials();
    } else {
      location.href = "login.html";
    }
  });
</script>

</body>
</html>

