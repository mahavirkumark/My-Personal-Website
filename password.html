<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Credential Manager</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <style>
    /* Animations */
    .fade-in { opacity: 0; transform: translateY(20px); animation: fadeInUp 0.8s forwards; }
    .slide-left { opacity: 0; transform: translateX(-20px); animation: slideLeft 0.8s forwards; }
    .slide-right { opacity: 0; transform: translateX(20px); animation: slideRight 0.8s forwards; }

    @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
    @keyframes slideLeft { to { opacity: 1; transform: translateX(0); } }
    @keyframes slideRight { to { opacity: 1; transform: translateX(0); } }

    nav a { transition: transform 0.3s, color 0.3s; }
    nav a:hover { transform: translateY(-2px); color: #3b82f6; }
  </style>
</head>
<body class="bg-gray-100 text-gray-700 font-sans">

<!-- Desktop Layout -->
<div class="hidden md:block fade-in">
  <header class="bg-white shadow-md p-4 flex justify-between items-center">
    <div class="flex items-center gap-3 slide-left">
      <i class="fas fa-user-circle text-3xl text-blue-500"></i>
      <h1 class="text-2xl font-bold text-black">My Personal Website</h1>
    </div>

  <a href="home.html" class="flex items-center gap-2"><i class="fas fa-house"></i> Home</a>
<a href="address.html" class="flex items-center gap-2"><i class="fas fa-tasks"></i> Address</a>
<a href="income.html" class="flex items-center gap-2"><i class="fas fa-wallet"></i> Income</a>
<a href="links.html" class="flex items-center gap-2"><i class="fas fa-link"></i> Links</a>
<a href="calendar.html" class="flex items-center gap-2"><i class="fas fa-calendar-days"></i> Calendar</a>
<a href="birthday.html" class="flex items-center gap-2"><i class="fas fa-cake-candles"></i> Birthday</a>
<a href="password.html" class="flex items-center gap-2"><i class="fas fa-lock"></i> Passwords</a>
    </nav>

    <div class="flex items-center gap-4 slide-left">
      <div class="text-right">
        <p id="user-name" class="font-medium text-black text-base">User Name</p>
        <p id="user-email" class="text-sm text-gray-500">user@example.com</p>
      </div>
      <img id="user-pic" src="https://via.placeholder.com/100" alt="User Photo" class="w-12 h-12 rounded-full border" />
      <button id="logout-btn" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm">Logout</button>
    </div>
  </header>

  <div class="w-full px-6 mx-auto mt-4 grid grid-cols-1 md:grid-cols-3 gap-4 max-w-screen-2xl">
    <!-- Add Credential Form -->
    <div class="bg-white rounded shadow p-5 flex flex-col space-y-2 md:col-span-1 fade-in">
      <h2 class="text-lg font-semibold mb-1 text-center">Add New Credential</h2>
      <input id="title" class="border px-3 py-2 rounded text-sm" placeholder="App / Website Name (Required)" />
      <input id="email" class="border px-3 py-2 rounded text-sm" placeholder="Email (Optional)" />
      <input id="username" class="border px-3 py-2 rounded text-sm" placeholder="Username (Optional)" />
      <input id="password" class="border px-3 py-2 rounded text-sm" placeholder="Password (Optional)" />
      <button id="save-btn" class="bg-blue-900 text-white text-sm py-2 rounded hover:bg-blue-800 mt-2">
        <i class="fas fa-save mr-2"></i> Save Credential
      </button>
      <p id="save-message" class="text-center text-sm text-green-600 font-medium hidden">Credential saved!</p>
    </div>

    <!-- Saved Credentials -->
    <div class="bg-white rounded shadow p-6 flex flex-col space-y-4 md:col-span-2 fade-in">
      <h2 class="text-lg font-semibold text-center">Saved Credentials</h2>
      <div class="flex justify-center">
        <input type="text" id="searchInput" placeholder="🔍 Search your passwords..." class="w-full max-w-2xl px-5 py-4 border border-gray-600 rounded-full shadow-sm focus:outline-none focus:ring-5 focus:ring-blue-600 text-[18px] font-bold transition" />
      </div>
      <div id="cred-list" class="grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-[65vh] overflow-y-auto"></div>
    </div>
  </div>
</div>

<!-- Mobile Layout -->
<div class="block md:hidden fade-in">
  <header class="bg-white shadow-md">
    <div class="flex justify-between items-center py-2 px-4">
      <div class="flex items-center gap-2 slide-left">
        <i class="fas fa-user-circle text-2xl text-blue-500"></i>
        <h1 class="text-lg font-bold text-black">My Personal Website</h1>
      </div>
      <button id="menu-btn" class="text-gray-700 hover:text-blue-500 focus:outline-none p-2 rounded-lg">
        <i class="fas fa-bars text-xl"></i>
      </button>
    </div>
  </header>

  <nav id="mobile-menu" class="hidden bg-white px-6 pb-6 space-y-3 text-base font-normal text-gray-800 rounded-b shadow-md">
    <a href="home.html" class="flex items-center gap-2 px-3 py-2 rounded hover:bg-gray-100"><i class="fas fa-house"></i> Home</a>
    <a href="adress.html" class="flex items-center gap-2"><i class="fas fa-tasks"></i> Address</a>
    <a href="income.html" class="flex items-center gap-2"><i class="fas fa-wallet"></i> Income</a>
    <a href="links.html" class="flex items-center gap-2"><i class="fas fa-link"></i> Links</a>
    <a href="calender.html" class="flex items-center gap-2"><i class="fas fa-calendar-days"></i> Calendar</a>
    <a href="password.html" class="flex items-center gap-2"><i class="fas fa-lock"></i> Passwords</a>

    <button id="mobileProfileBtn" class="flex items-center gap-2 mt-4 w-full text-left px-3 py-2 rounded hover:bg-gray-100 focus:outline-none">
      <i class="fas fa-user-circle text-2xl"></i>
      <span class="font-medium">Profile</span>
      <i class="fas fa-chevron-down ml-auto transition-transform duration-300" id="mobileProfileChevron"></i>
    </button>

    <div id="mobileProfilePanel" class="hidden mt-2 p-3 border rounded bg-gray-50 space-y-2">
      <p id="mobileUserName" class="font-medium text-gray-800 text-sm">User Name</p>
      <p id="mobileUserEmail" class="text-xs text-gray-500">user@example.com</p>
      <button id="mobileLogout" class="w-full mt-1 bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm">Logout</button>
    </div>
  </nav>

  <div class="bg-white rounded-lg shadow-lg p-4 mx-2 my-6 flex flex-col space-y-6 fade-in">
    <div class="bg-white rounded-lg shadow p-4 space-y-3 w-full">
      <h3 class="text-lg font-semibold mb-2 text-center text-gray-700">Add New Credential</h3>
      <input id="title-m" class="border px-3 py-2 rounded text-sm w-full focus:ring-2 focus:ring-blue-500" placeholder="App / Website Name (Required)" />
      <input id="email-m" class="border px-3 py-2 rounded text-sm w-full focus:ring-2 focus:ring-blue-500" placeholder="Email (Optional)" />
      <input id="username-m" class="border px-3 py-2 rounded text-sm w-full focus:ring-2 focus:ring-blue-500" placeholder="Username (Optional)" />
      <input id="password-m" class="border px-3 py-2 rounded text-sm w-full focus:ring-2 focus:ring-blue-500" placeholder="Password (Optional)" />

      <button id="save-btn-m" class="bg-blue-700 text-white text-sm py-2 rounded hover:bg-blue-600 mt-2 w-full flex justify-center items-center font-medium transition">
        <i class="fas fa-save mr-2"></i> Save Credential
      </button>
      <p id="save-message-m" class="text-center text-sm text-green-600 font-medium hidden">Credential saved!</p>
    </div>

    <input type="text" id="searchInputMobile" placeholder="🔍 Search your passwords..." class="w-full px-3 py-2 border border-gray-400 rounded-full shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm font-medium transition" />
    <h2 class="text-lg font-semibold text-center">Saved Credentials</h2>
    <div id="cred-list-mobile" class="grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
  </div>
</div>

<footer class="mt-12 pt-3 pb-3 bg-white text-gray-600 text-center text-sm border-t">
  &copy; 2025 Personal Website | All rights reserved
</footer>
<script>
  // ✅ Firebase Configuration
  const firebaseConfig = {
    apiKey: "AIzaSyB78RTVCg0cmSPp7A1RJyyAgBuCeolO0cc",
    authDomain: "sk12-58e9e.firebaseapp.com",
    databaseURL: "https://sk12-58e9e-default-rtdb.firebaseio.com",
    projectId: "sk12-58e9e",
    storageBucket: "sk12-58e9e.appspot.com",
    messagingSenderId: "470207874652",
    appId: "1:470207874652:web:67ba1cf3629b7e5b144899"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.database();
  let currentUser = null;

  // ✅ Crypto helpers
  async function getKey(uid) {
    const enc = new TextEncoder();
    const base = await crypto.subtle.digest("SHA-256", enc.encode(uid + "_secret_key"));
    return crypto.subtle.importKey("raw", base, { name: "AES-GCM" }, false, ["encrypt","decrypt"]);
  }

  async function encryptString(text, uid) {
    const key = await getKey(uid);
    const iv = crypto.getRandomValues(new Uint8Array(12));
    const enc = new TextEncoder().encode(text);
    const buf = await crypto.subtle.encrypt({ name: "AES-GCM", iv }, key, enc);
    return btoa(String.fromCharCode(...iv) + String.fromCharCode(...new Uint8Array(buf)));
  }

  async function decryptString(base64, uid) {
    try {
      const raw = atob(base64);
      const iv = Uint8Array.from(raw.slice(0,12), c=>c.charCodeAt(0));
      const data = Uint8Array.from(raw.slice(12), c=>c.charCodeAt(0));
      const key = await getKey(uid);
      const dec = await crypto.subtle.decrypt({ name:"AES-GCM", iv }, key, data);
      return new TextDecoder().decode(dec);
    } catch {
      return ""; // fallback if corrupted/plaintext
    }
  }

  // ✅ Copy to clipboard
  function copyToClipboard(text, button) {
    navigator.clipboard.writeText(text).then(() => {
      const originalText = "Copy";
      const newText = "Copied!";
      button.innerText = newText;
      button.disabled = true;
      button.classList.remove("bg-blue-600");
      button.classList.add("bg-green-600");
      button.style.transform = "scale(1.1)";
      button.style.transition = "all 0.2s ease-in-out";
      setTimeout(() => {
        button.innerText = originalText;
        button.disabled = false;
        button.classList.remove("bg-green-600");
        button.classList.add("bg-blue-600");
        button.style.transform = "scale(1)";
      }, 1500);
    });
  }

  // ✅ Toggle password/email/username visibility
  function toggleVisibility(button) {
    const parent = button.closest("p");
    if (!parent) return;
    const valueSpan = parent.querySelector(".cred-value");
    const isHidden = valueSpan.textContent === "••••••••";
    if (isHidden) {
      valueSpan.textContent = valueSpan.getAttribute("data-original");
      button.innerHTML = `<i class="fas fa-eye"></i>`;
      button.classList.remove("text-gray-500");
      button.classList.add("text-blue-600");
    } else {
      valueSpan.textContent = "••••••••";
      button.innerHTML = `<i class="fas fa-eye-slash"></i>`;
      button.classList.remove("text-blue-600");
      button.classList.add("text-gray-500");
    }
  }

  // ✅ Save credential (desktop + mobile)
  async function saveCredential(isMobile=false) {
    const title = document.getElementById(isMobile?"title-m":"title")?.value.trim();
    const email = document.getElementById(isMobile?"email-m":"email")?.value.trim();
    const username = document.getElementById(isMobile?"username-m":"username")?.value.trim();
    const password = document.getElementById(isMobile?"password-m":"password")?.value.trim();
    if (!title) { alert("App/Website title is required!"); return; }
    const id = Date.now().toString();
    db.ref(`users/${currentUser.uid}/credentials/${id}`).set({
      title,
      email: email?await encryptString(email,currentUser.uid):"",
      username: username?await encryptString(username,currentUser.uid):"",
      password: password?await encryptString(password,currentUser.uid):""
    });
    // Clear fields
    ["title","email","username","password"].forEach(f=>{
      if(isMobile) f+="-m";
      const el=document.getElementById(f);
      if(el) el.value="";
    });
  }

  // ✅ Load and decrypt credentials
  async function loadCredentials() {
    const desktopList = document.getElementById("cred-list");
    const mobileList = document.getElementById("cred-list-mobile");
    if(desktopList) desktopList.innerHTML=`<p class="text-gray-500">Loading...</p>`;
    if(mobileList) mobileList.innerHTML=`<p class="text-gray-500">Loading...</p>`;

    db.ref(`users/${currentUser.uid}/credentials`).on("value", async snapshot=>{
      if(desktopList) desktopList.innerHTML="";
      if(mobileList) mobileList.innerHTML="";
      if(!snapshot.exists()){
        const msg=`<p class="text-gray-500">No credentials found.</p>`;
        if(desktopList) desktopList.innerHTML=msg;
        if(mobileList) mobileList.innerHTML=msg;
        return;
      }

      for(const [id,data] of Object.entries(snapshot.val())){
        const decEmail = data.email?await decryptString(data.email,currentUser.uid):"";
        const decUsername = data.username?await decryptString(data.username,currentUser.uid):"";
        const decPassword = data.password?await decryptString(data.password,currentUser.uid):"";

        const safeData=encodeURIComponent(JSON.stringify({title:data.title,email:decEmail,username:decUsername,password:decPassword}));

        const html = `
        <div class="password-item border p-4 rounded shadow bg-gray-50 flex flex-col" data-id="${id}">
          <h3 class="website-name font-semibold text-lg text-black mb-2">${data.title || "Untitled"}</h3>
          ${decEmail?`<p class="text-sm text-gray-600 flex items-center justify-between mb-1">
            <span>Email: <span class="cred-value" data-original="${decEmail}">••••••••</span></span>
            <span class="flex items-center gap-1">
              <button onclick="toggleVisibility(this)" class="text-gray-500 hover:text-gray-900 text-sm"><i class="fas fa-eye-slash"></i></button>
              <button onclick="copyToClipboard('${decEmail}', this)" class="px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700">Copy</button>
            </span>
          </p>`:""}
          ${decUsername?`<p class="text-sm text-gray-600 flex items-center justify-between mb-1">
            <span>Username: <span class="cred-value" data-original="${decUsername}">••••••••</span></span>
            <span class="flex items-center gap-1">
              <button onclick="toggleVisibility(this)" class="text-gray-500 hover:text-gray-900 text-sm"><i class="fas fa-eye-slash"></i></button>
              <button onclick="copyToClipboard('${decUsername}', this)" class="px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700">Copy</button>
            </span>
          </p>`:""}
          ${decPassword?`<p class="text-sm text-gray-600 flex items-center justify-between mb-1">
            <span>Password: <span class="cred-value" data-original="${decPassword}">••••••••</span></span>
            <span class="flex items-center gap-1">
              <button onclick="toggleVisibility(this)" class="text-gray-500 hover:text-gray-900 text-sm"><i class="fas fa-eye-slash"></i></button>
              <button onclick="copyToClipboard('${decPassword}', this)" class="px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700">Copy</button>
            </span>
          </p>`:""}
          <div class="mt-3 flex gap-3 justify-start">
            <button onclick="editCredential('${id}', '${safeData}')" class="text-blue-600 hover:underline"><i class="fas fa-edit mr-1"></i>Edit</button>
            <button onclick="deleteCredential('${id}')" class="text-red-600 hover:underline"><i class="fas fa-trash mr-1"></i>Delete</button>
            <button onclick="shareCredential('${safeData}')" class="text-green-600 hover:underline"><i class="fas fa-share-alt mr-1"></i>Share</button>
          </div>
        </div>`;
        if(desktopList) desktopList.innerHTML+=html;
        if(mobileList) mobileList.innerHTML+=html;
      }
    });
  }

  // ✅ Edit credential
  async function editCredential(id, encoded) {
    const data = JSON.parse(decodeURIComponent(encoded));
    const newTitle = prompt("Edit Title:", data.title||"");
    const newEmail = prompt("Edit Email:", data.email||"");
    const newUsername = prompt("Edit Username:", data.username||"");
    const newPassword = prompt("Edit Password:", data.password||"");
    if(newTitle!==null){
      db.ref(`users/${currentUser.uid}/credentials/${id}`).set({
        title: newTitle,
        email: newEmail?await encryptString(newEmail,currentUser.uid):"",
        username: newUsername?await encryptString(newUsername,currentUser.uid):"",
        password: newPassword?await encryptString(newPassword,currentUser.uid):""
      });
    }
  }

  // ✅ Delete credential
  function deleteCredential(id){
    if(confirm("Are you sure you want to delete this credential?")){
      db.ref(`users/${currentUser.uid}/credentials/${id}`).remove();
    }
  }

  // ✅ Share credential (Web Share API)
  function shareCredential(encoded){
    const data=JSON.parse(decodeURIComponent(encoded));
    let text=`Website/App: ${data.title}\n`;
    if(data.email) text+=`Email: ${data.email}\n`;
    if(data.username) text+=`Username: ${data.username}\n`;
    if(data.password) text+=`Password: ${data.password}\n`;
    if(navigator.share){
      navigator.share({title:`Credential for ${data.title}`, text}).catch(()=>alert("Sharing failed."));
    } else alert("Sharing not supported on this browser.");
  }

  // ✅ Search
  function filterPasswords(){const q=document.getElementById("searchInput")?.value.toLowerCase()||"";document.querySelectorAll("#cred-list .password-item").forEach(item=>{const w=item.querySelector(".website-name")?.textContent.toLowerCase()||"";item.style.display=w.includes(q)?"block":"none";});}
  function filterPasswordsMobile(){const q=document.getElementById("searchInputMobile")?.value.toLowerCase()||"";document.querySelectorAll("#cred-list-mobile .password-item").forEach(item=>{const w=item.querySelector(".website-name")?.textContent.toLowerCase()||"";item.style.display=w.includes(q)?"block":"none";});}

  // ✅ Event listeners
  document.getElementById("save-btn")?.addEventListener("click",()=>saveCredential(false));
  document.getElementById("save-btn-m")?.addEventListener("click",()=>saveCredential(true));
  document.getElementById("searchInput")?.addEventListener("input",filterPasswords);
  document.getElementById("searchInputMobile")?.addEventListener("input",filterPasswordsMobile);

  // ✅ Auth listener
  auth.onAuthStateChanged(user=>{
    if(user){
      currentUser=user;
      // Desktop profile
      document.getElementById("user-name").innerText=user.displayName||"User";
      document.getElementById("user-email").innerText=user.email||"";
      document.getElementById("user-pic").src=user.photoURL||"https://via.placeholder.com/40";
      // Mobile profile
      const mobileName=document.getElementById("mobileUserName");
      const mobileEmail=document.getElementById("mobileUserEmail");
      if(mobileName) mobileName.innerText=user.displayName||"User";
      if(mobileEmail) mobileEmail.innerText=user.email||"";
      // Load decrypted credentials
      loadCredentials();
    } else location.href="index.html";
  });

  // Logout buttons
  document.getElementById("logout-btn")?.addEventListener("click",()=>auth.signOut());
  document.getElementById("mobileLogout")?.addEventListener("click",()=>auth.signOut());
</script>




</body>
</html>







































