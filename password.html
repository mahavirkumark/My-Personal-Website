<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Credential Manager</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>
<body class="bg-gray-100 text-gray-700">

<!-- DESKTOP / LAPTOP LAYOUT -->
<div class="hidden md:block">
  <nav class="bg-white shadow p-4 flex justify-between items-center mb-6">
    <!-- Left: Title -->
    <div class="flex items-center gap-2 text-xl font-bold text-black">
      <i class="fas fa-user"></i> My Personal Website
    </div>
    <!-- Center: Nav Links -->
    <div class="flex space-x-12 text-black text-lg">
      <a href="home.html" class="hover:text-blue-500 flex items-center gap-1"><i class="fas fa-house"></i> Home</a>
      <a href="adress.html" class="hover:text-blue-500 flex items-center gap-1"><i class="fas fa-tasks"></i> Address</a>
      <a href="password.html" class="hover:text-blue-500 flex items-center gap-1"><i class="fas fa-key"></i> Passwords</a>
      <a href="income.html" class="hover:text-blue-500 flex items-center gap-1"><i class="fas fa-wallet"></i> Income</a>
      <a href="links.html" class="hover:text-blue-500 flex items-center gap-1"><i class="fas fa-link"></i> Links</a>
      <a href="calender.html" class="hover:text-blue-500 flex items-center gap-1"><i class="fas fa-calendar-alt"></i> Calendar</a>
    </div>
    <!-- Right: User info -->
    <div class="flex items-center space-x-3">
      <div class="text-right">
        <p id="user-name" class="font-medium text-black text-sm">User Name</p>
        <p id="user-email" class="text-xs text-gray-600">user@example.com</p>
        <p id="user-id" class="text-xs text-gray-400 hidden">UID here</p>
      </div>
      <img id="user-pic" src="" alt="User Photo" width="40" class="rounded-full border" />
      <button id="logout-btn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded text-sm">Logout</button>
    </div>
  </nav>

  <div class="w-full px-6 mx-auto mt-2 grid grid-cols-1 md:grid-cols-3 gap-4 max-w-screen-2xl">
    <!-- Add Credential -->
    <div class="bg-white rounded shadow p-5 flex flex-col space-y-2 md:col-span-1">
      <h2 class="text-lg font-semibold mb-1 text-center">Add New Credential</h2>
      <input id="title" class="border px-3 py-2 rounded text-sm" placeholder="App / Website Name (Required)" />
      <input id="email" class="border px-3 py-2 rounded text-sm" placeholder="Email (Optional)" />
      <input id="username" class="border px-3 py-2 rounded text-sm" placeholder="Username (Optional)" />
      <input id="password" class="border px-3 py-2 rounded text-sm" placeholder="Password (Optional)" />
      <button onclick="saveCredential()" class="bg-blue-900 text-white text-sm py-2 rounded hover:bg-blue-800 mt-2">
        <i class="fas fa-save mr-2"></i> Save Credential
      </button>
    </div>

    <!-- Saved Credentials + Search -->
    <div class="bg-white rounded shadow p-6 flex flex-col space-y-4 md:col-span-2">
      <h2 class="text-lg font-semibold text-center">Saved Credentials</h2>
      <div class="flex justify-center">
        <input type="text" id="searchInput" placeholder="🔍 Search your passwords..."
          class="w-full max-w-2xl px-5 py-4 border border-gray-600 rounded-full shadow-sm focus:outline-none focus:ring-5 focus:ring-blue-600 text-[18px] font-bold transition"
          oninput="filterPasswords()" />
      </div>
      <div id="cred-list" class="grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-[65vh] overflow-y-auto"></div>
    </div>
  </div>
</div>

<!-- MOBILE LAYOUT -->
<div class="block md:hidden">
  <nav class="bg-white shadow p-4 flex justify-between items-center mb-4">
    <div class="flex items-center gap-2 text-xl font-bold text-black">
      <i class="fas fa-user"></i> My Website
    </div>
    <button id="menu-btn" class="text-gray-700 focus:outline-none">
      <i class="fas fa-bars fa-lg"></i>
    </button>
  </nav>

  <div id="mobile-menu" class="hidden bg-white px-4 py-3 space-y-3 shadow rounded mb-4">
    <a href="home.html" class="flex items-center gap-1 hover:text-blue-500"><i class="fas fa-house"></i> Home</a>
    <a href="adress.html" class="flex items-center gap-1 hover:text-blue-500"><i class="fas fa-tasks"></i> Address</a>
    <a href="password.html" class="flex items-center gap-1 hover:text-blue-500"><i class="fas fa-key"></i> Passwords</a>
    <a href="income.html" class="flex items-center gap-1 hover:text-blue-500"><i class="fas fa-wallet"></i> Income</a>
    <a href="links.html" class="flex items-center gap-1 hover:text-blue-500"><i class="fas fa-link"></i> Links</a>
    <a href="calender.html" class="flex items-center gap-1 hover:text-blue-500"><i class="fas fa-calendar-alt"></i> Calendar</a>
  </div>

  <!-- Add Credential -->
  <div class="bg-white rounded shadow p-5 flex flex-col space-y-2 mb-4 mx-4">
    <h2 class="text-lg font-semibold mb-1 text-center">Add New Credential</h2>
    <input id="title-m" class="border px-3 py-2 rounded text-sm" placeholder="App / Website Name (Required)" />
    <input id="email-m" class="border px-3 py-2 rounded text-sm" placeholder="Email (Optional)" />
    <input id="username-m" class="border px-3 py-2 rounded text-sm" placeholder="Username (Optional)" />
    <input id="password-m" class="border px-3 py-2 rounded text-sm" placeholder="Password (Optional)" />
    <button onclick="saveCredentialMobile()" class="bg-blue-900 text-white text-sm py-2 rounded hover:bg-blue-800 mt-2">
      <i class="fas fa-save mr-2"></i> Save Credential
    </button>
  </div>

  <!-- Saved Credentials + Search -->
  <div class="bg-white rounded shadow p-4 mx-4 mb-6 flex flex-col space-y-4">
    <h2 class="text-lg font-semibold text-center">Saved Credentials</h2>
    <input type="text" id="searchInputMobile" placeholder="🔍 Search your passwords..."
      class="w-full px-4 py-3 border border-gray-600 rounded-full shadow-sm focus:outline-none focus:ring-5 focus:ring-blue-600 text-sm font-bold transition"
      oninput="filterPasswordsMobile()" />
    <div id="cred-list-mobile" class="grid sm:grid-cols-1 gap-3 max-h-[60vh] overflow-y-auto"></div>
  </div>
</div>












  <!-- Credential List -->
 

<!-- ✅ Footer -->
<footer class="mt-10 bg-white text-gray-600 text-center p-4 border-t">
  &copy; 2025 Personal Website | All rights reserved
</footer>

<script>
  // ✅ Mobile menu toggle
  const btn = document.getElementById("menu-btn");
  const menu = document.getElementById("mobile-menu");
  if (btn && menu) {
    btn.addEventListener("click", () => menu.classList.toggle("hidden"));
  }

  // ✅ Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyB78RTVCg0cmSPp7A1RJyyAgBuCeolO0cc",
    authDomain: "sk12-58e9e.firebaseapp.com",
    databaseURL: "https://sk12-58e9e-default-rtdb.firebaseio.com",
    projectId: "sk12-58e9e",
    storageBucket: "sk12-58e9e.appspot.com",
    messagingSenderId: "470207874652",
    appId: "1:470207874652:web:67ba1cf3629b7e5b144899"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.database();
  let currentUser = null;

  // ✅ Modern copy function
  function copyToClipboard(text, button) {
    navigator.clipboard.writeText(text).then(() => {
      button.innerText = "✔ Copied!";
      button.disabled = true;
      button.classList.remove("bg-blue-600");
      button.classList.add("bg-green-600");
      button.style.transform = "scale(1.1)";
      button.style.transition = "all 0.2s ease-in-out";

      setTimeout(() => {
        button.innerText = "Copy";
        button.disabled = false;
        button.classList.remove("bg-green-600");
        button.classList.add("bg-blue-600");
        button.style.transform = "scale(1)";
      }, 1500);
    });
  }

  // ✅ Save credential (desktop)
  function saveCredential() {
    const title = document.getElementById("title")?.value.trim();
    const email = document.getElementById("email")?.value.trim();
    const username = document.getElementById("username")?.value.trim();
    const password = document.getElementById("password")?.value.trim();
    if (!title) { alert("App/Website title is required!"); return; }
    const id = Date.now().toString();
    db.ref(`users/${currentUser.uid}/credentials/${id}`).set({ title, email, username, password });
    ["title","email","username","password"].forEach(id => { const el = document.getElementById(id); if(el) el.value=""; });
  }

  // ✅ Save credential (mobile)
  function saveCredentialMobile() {
    const title = document.getElementById("title-m")?.value.trim();
    const email = document.getElementById("email-m")?.value.trim();
    const username = document.getElementById("username-m")?.value.trim();
    const password = document.getElementById("password-m")?.value.trim();
    if (!title) { alert("App/Website title is required!"); return; }
    const id = Date.now().toString();
    db.ref(`users/${currentUser.uid}/credentials/${id}`).set({ title, email, username, password });
    ["title-m","email-m","username-m","password-m"].forEach(id => { const el = document.getElementById(id); if(el) el.value=""; });
  }

  // ✅ Load credentials with modern copy and line spacing
  function loadCredentials() {
    const desktopList = document.getElementById("cred-list");
    const mobileList = document.getElementById("cred-list-mobile");
    if(desktopList) desktopList.innerHTML = `<p class="text-gray-500">Loading...</p>`;
    if(mobileList) mobileList.innerHTML = `<p class="text-gray-500">Loading...</p>`;

    db.ref(`users/${currentUser.uid}/credentials`).on("value", snapshot => {
      if(desktopList) desktopList.innerHTML = "";
      if(mobileList) mobileList.innerHTML = "";

      if(!snapshot.exists()) {
        if(desktopList) desktopList.innerHTML = `<p class="text-gray-500">No credentials found.</p>`;
        if(mobileList) mobileList.innerHTML = `<p class="text-gray-500">No credentials found.</p>`;
        return;
      }

      snapshot.forEach(child => {
        const data = child.val();
        const id = child.key;
        const safeData = encodeURIComponent(JSON.stringify(data));

        let html = `<div class="password-item border p-3 rounded shadow bg-gray-50 mb-3">
                      <h3 class="website-name font-semibold text-lg mb-2">${data.title || ""}</h3>`;

        if(data.email) html += `<p class="text-sm text-gray-600 flex items-center justify-between mb-1">Email: ${data.email} 
                                  <button onclick="copyToClipboard('${data.email}', this)" 
                                  class="ml-2 px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700">Copy</button></p>`;
        if(data.username) html += `<p class="text-sm text-gray-600 flex items-center justify-between mb-1">Username: ${data.username} 
                                  <button onclick="copyToClipboard('${data.username}', this)" 
                                  class="ml-2 px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700">Copy</button></p>`;
        if(data.password) html += `<p class="text-sm text-gray-600 flex items-center justify-between mb-1">Password: ${data.password} 
                                  <button onclick="copyToClipboard('${data.password}', this)" 
                                  class="ml-2 px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700">Copy</button></p>`;

        html += `<div class="mt-3 flex gap-3">
                    <button onclick="editCredential('${id}', '${safeData}')" class="text-blue-600 hover:underline"><i class="fas fa-edit mr-1"></i>Edit</button>
                    <button onclick="deleteCredential('${id}')" class="text-red-600 hover:underline"><i class="fas fa-trash mr-1"></i>Delete</button>
                 </div></div>`;

        if(desktopList) desktopList.innerHTML += html;
        if(mobileList) mobileList.innerHTML += html;
      });

      filterPasswords();
      filterPasswordsMobile();
    });
  }

  // ✅ Edit credential
  function editCredential(id, encoded) {
    const data = JSON.parse(decodeURIComponent(encoded));
    const newTitle = prompt("Edit Title:", data.title || "");
    const newEmail = prompt("Edit Email:", data.email || "");
    const newUsername = prompt("Edit Username:", data.username || "");
    const newPassword = prompt("Edit Password:", data.password || "");
    if(newTitle !== null) {
      db.ref(`users/${currentUser.uid}/credentials/${id}`).set({
        title: newTitle,
        email: newEmail || "",
        username: newUsername || "",
        password: newPassword || ""
      });
    }
  }

  // ✅ Delete credential
  function deleteCredential(id) {
    if(confirm("Are you sure you want to delete this credential?")) {
      db.ref(`users/${currentUser.uid}/credentials/${id}`).remove();
    }
  }

  // ✅ Search desktop
  function filterPasswords() {
    const query = document.getElementById("searchInput")?.value.toLowerCase() || "";
    document.querySelectorAll("#cred-list .password-item").forEach(item => {
      const website = item.querySelector(".website-name")?.textContent.toLowerCase() || "";
      item.style.display = website.includes(query) ? "block" : "none";
    });
  }

  // ✅ Search mobile
  function filterPasswordsMobile() {
    const query = document.getElementById("searchInputMobile")?.value.toLowerCase() || "";
    document.querySelectorAll("#cred-list-mobile .password-item").forEach(item => {
      const website = item.querySelector(".website-name")?.textContent.toLowerCase() || "";
      item.style.display = website.includes(query) ? "block" : "none";
    });
  }

  // ✅ Auth handling
  const logoutBtn = document.getElementById("logout-btn");
  if (logoutBtn) logoutBtn.addEventListener("click", ()=> auth.signOut());

  document.getElementById("searchInput")?.addEventListener("input", filterPasswords);
  document.getElementById("searchInputMobile")?.addEventListener("input", filterPasswordsMobile);

  auth.onAuthStateChanged(user => {
    if(user){
      currentUser = user;
      document.getElementById("user-name").innerText = user.displayName || "User";
      document.getElementById("user-email").innerText = user.email || "";
      document.getElementById("user-id").innerText = user.uid;
      document.getElementById("user-pic").src = user.photoURL || "https://via.placeholder.com/40";
      loadCredentials();
    } else {
      location.href = "index.html";
    }
  });
</script>


</body>
</html>





